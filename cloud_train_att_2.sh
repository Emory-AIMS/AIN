#!/bin/bash
python3 ./code/run_attain.py --train --NUM_EPOCHS 200 --BATCH_SIZE 80 --EVAL_FREQUENCY 50\
    --DATA_DIR ../tiny-imagenet-200\
    --AE_TYPE ATTAE\
    --ATT_TYPE TRAD\
    --NUM_PRE_EPOCHS 12 --PRE_EVAL_FREQUENCY 1\
    --NUM_ACCUM_ITERS 1\
    --GAMMA_R 1e-3 --GAMMA_L 1.0\
    --REG_SCALE 2e-3\
    --OPT_TYPE ADAM --LEARNING_RATE 2e-4 --LEARNING_DECAY_RATE 0.99 --LEARNING_DECAY_STEPS 2000\
    --IS_GRAD_CLIPPING --GRAD_CLIPPING_NORM 1.0\
    --LOSS_MODE_TRANS C_W2 --LOSS_MODE_CLEAN C_W2\
    --BETA_X_TRUE 1e-2 --BETA_X_TRUE_CHANGE_RATE 1.1 --BETA_X_TRUE_CHANGE_EPOCHS 8 --MAX_BETA_X_TRUE 0.1\
    --BETA_X_FAKE 10.0 --BETA_X_FAKE_CHANGE_RATE 1.1 --BETA_X_FAKE_CHANGE_EPOCHS 8 --MAX_BETA_X_FAKE 500\
    --KAPPA_FOR_TRANS 200 --KAPPA_FOR_FAKE 200 --KAPPA_FOR_CLEAN 200\
    --BETA_Y_TRANS 20 --BETA_Y_TRANS_CHANGE_RATE 1.2 --BETA_Y_TRANS_CHANGE_EPOCHS 8 --MAX_BETA_Y_TRANS 500\
    --BETA_Y_FAKE 0.1 --BETA_Y_FAKE_CHANGE_RATE 1.2 --BETA_Y_FAKE_CHANGE_EPOCHS 8 --MAX_BETA_Y_FAKE 1\
    --BETA_Y_CLEAN 20 --BETA_Y_CLEAN_CHANGE_RATE 1.2 --BETA_Y_CLEAN_CHANGE_EPOCHS 8 --MAX_BETA_Y_CLEAN 500\
    --PIXEL_BOUND 0.1 --BOUND_CHANGE_RATE 0.8 --BOUND_CHANGE_EPOCHS 8 --MIN_BOUND 0.001\
    --ENC_NORM BATCH --DEC_NORM BATCH\
    --CENTRAL_CHANNEL_SIZE 3\
    --NUM_ENC_RES_BLOCK 1 --ENC_RES_BLOCK_SIZE 1\
    --NUM_DEC_RES_BLOCK 1 --DEC_RES_BLOCK_SIZE 1\
    --EPSILON 5e-4\
    --FGM_ITERS 20